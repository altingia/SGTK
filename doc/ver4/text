---1
Hi! I am Olga Chernikova. I am working on
project "scaffold graph visualization and RNA scaffolding". My menter is
Andrey Prjibelski.  

---2
There are a lot of programs for assemblering genome by reads.  

---3
But all this programm will produce draft version of the genomes. In 
which the chromosome are assembled into large number of contigs. 

Also information about contig order is important too. 

We are going to find out the order of this contigs. Build scaffolds. 

---4
Typicly assemblers also produce scaffolds. And the most of time they 
use information about pair reads for connected contigs in larger scaffolds. 

For pair reads we know distance between them and order. We can aligment them to 
the contigs and find out the correct order.

---5

We going to use RNA for connect contig in scaffolds.

---6

Principl looks similar. I am going to tell about that in the futer. 

And it looks like RNA can give extra information about contig order. 
For example, because the intron lenth can be bigger then insertion lenth in 
pair reads. As results it is imposible for take this information from 
DNA pair reads. 

Also it can help if gene split on different contigs to merge them to one 
scaffolds. It can be usefull for example, for gene anottation. 

---7

Goal of my project is build RNA-seq scaffolder. 

There are few softs witch do that. And all of them not perfect. 
We hope that we can improve current results. 

Also important part of my project is 
a contig graph vesualisation. 

And I start my store with that. 
---8

OK. My visualization is quate simple. Let us we alreade have a graph. I split this graph 
in parts. Size of this part is arount 10-20 vertexis. Each part print in separati 
dot file. After that it converts to ps file.  

On this vertex contig is a vertex. And edge is connection between contigs. 
Here we have the name of contig, internal id, contig lenth. Also if reference is provided 
we can see coordinats at this reference.  


About connection we tell lib name. Edge weight is the number of reads on the basis of withch the connection was establish. 
Internal edge id. Also provide coordinats of the reads on contigs. 

Yelow color of vertex mean that this vertex has other conection in other parts.

On the next slides pictures will be simplifast.

---9

Also we can visualize a lot of tapy of connection. The first one is our RNA connection. Here show two tepys of it what does it mean I will explain later. If we provide reference we can show reference connection. It is red on the picture. Also we can visualize scaffolds/ Here it is yelow, green and
brown. My scaffolder is yelow. For example here we can see that I find connection, but other scaffolder - does not. And here my connection and connection of P_RNA_scaffolder is wrong.

It is posible to set color of liblary. 

---10
Так же для более удобного анализа графа есть возможность выводить не весь граф, а только какие-то 
его участки. Например, оставить только контиги определенного размера, убрать ребра маленького веса. Вевести только те участки, где есть расхождения в каких-то двух библиотеках или вывести только те участки, в которых содержатся ошибки.  


---11
Теперь, когда мы уже знакомы с тем, что какие картинки обозначают перейдем к часте про построение скаффолдов. 

Первое что делается - это строится граф контигов. Для нахождения связей используется РНК и используются связи двух видов. На рисунке желтым цветом изображаются экзоны. Первый вид связи - это по парным ридам. На рисунке эта связь изображается синим. Собственно выравниваются парные риды и на их основание строится граф. 

Второй вид связи чуть более хитрый. Иногда сами риды попадают на стык экзонов. То есть риды, можно разрезать на две части, выравнить отдельную из половин и если они выравнились на разные контиги - то мы нашли очередную сваязь. 

---12 
После того как мы построили граф следующий модуль упрощает его и строит скаффолды. 

Первое упрощение - это удаления ребер маленького веса. Ребра веса один скорее всего ошибочные. Более интересный случай, если есть ребро веса три. Если у него больше нет соперников, то его вполне можно использовать для проведения связей. При этом, если у него был сосед веса 1, то скорее всего это ребро использовать не стоит и его тоже нужно удалить. 

Следующая вполне расспространненая ситуация, когда у нас есть ребра вдоль пути. Такие ребра я удаляю при этом увеличивая вес ребер на этом пути. 

---13
Следующая достаточно частая ситуация, это такие небольшие циклы. Их я просто удаляю. 

Если есть какая-та развилка, и вес одного из ребер сильно привосходит остальные, то я оставляют 
только макисмальное ребро. 

И в конце, когда все упращения сделаны я соединяю контиги вдоль простых путей в скаффолды. 


---14
Теперь вернемся к результатам. Недавно я переписала часть с построением скаффолдов и 
не могу предоставить новые результаты. Даже более того, часть с построением скаффолдов сейчас находится в актичной трансформации поэтому совсем свежих результатов нет.

На самом деле вот конкретно на этих данных результаты получаются лучше чем у остальных. Я пока тестировала только на C.elegans еще на 6 разных библиотеках. Еще в ближайшее время посмотрю что 
будет с T.suis и D.mekangaster и вероятно с человеком. Пока еще нет. 

В среднем на самом деле получается что-то среднее между P_RNA_scaffolder и rascaf и по количеству ошибок и по NGA50. 

Конкретно на этих данных именно связей вида когда рид делится на 
две части достаточно много и они еще здесь почти без мусора получаются. 
Наверное самый клевый результат здесь достигался на этих данных, если 
вообще выкинуть все парные риды и оставить только split риды. 


 
---15
При работе над проектом использовалось достаточно 
много вспомогательных инструментов. Язык разработки данного 
приложения - С++. Использовалась библиоткеа SeqAn для 
работы с геномными файлами. gtest библиотека для тестирования. 
Различные тулы для выранивания. QUAST это программа, которая
умеет оценивать качество сборки. И Tablet использовался для 
визуализации выранивания. 

---16
В целом, написаны скаффолдер и визуализатор. 

И в общем-то надо то что есть привести в более приличные вид. 
Сделать его пошустрее. Сравнить нормально с другими скаффолдарами. 
И скаффолдер в целом у меня еще не в конечной стадии. Я еще активно его меняю.

---17
Спасибо за внимание! Вопросы. 
