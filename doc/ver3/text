---1
Здраствуйте! Меня зовут Оля Черникова и я занимаюсь проектом 
про построение скаффолдов по ридам РНК и визуализацией графа 
связей между контигами. Мой научный руководитель - Андрей Пржибельский. 

---2
Сейчас речь пойдет про задачу сборки генома. 
Есть программы, ассемблеры, которые собирают 
геном из ридов. 

---3
Правда на выходе вместо уже полность собраным хромосом мы получаем 
только участки генома - контиги. На самом деле кроме самих контигов 
представляет интерес и их порядок и расстояние вставки. 

То есть еще интересны скаффолды. 
Задачей построения скаффолдов мы и будем заниматься.

---4

На самом деле на выходе ассемблер предоставляет не только контиги но и 
скаффолды. Чаще всего они строятся на основание парных ридов ДНК. То есть 
у нас есть парные риды ДНК между которыми мы знаем примерно расстояние вставки 
и их порядок, можно выровнить их на контиги и узнать порядок контигов. 

---5

В этом проекте мы используем риды РНК для построения скаффолдов. 
С точки зрения нахождения связей принцип достаточно похож.
У нас так же есть парные риды РНК,

---6

которые мы можем выравнить на контиги и получить связи между контигами. 
Подробнее про связи между контигами я расскажу чуть позже. 

Кажется, что использование РНК может помочь улучшить сборку и дать 
новую информацию о порядке по сранению с ридами ДНК. Во многом из-за того, 
что длина интрона может быть куда больше, чем расстояние вставки между 
парными ридами ДНК и как следствие по ним мы бы не получили информацию 
о порядки этих контигов. 

Востановление порядка таким образом может быть важно, для того, что бы 
гены находились в одном скаффолде, а ни не были разбросаны по разным 
независимым контигам.  

---7
В целом, как вы уже догадались, целью моего проекта является построение 
скаффолдов на основание РНК. На данный момент существуют несколько инструментов 
которые решают данную задачу. Это L_RNA_scaffolder, Rascaf, AGOUTI и еще, кажется, 
скоро должен выйти P_RNA_scaffolder, который, видимо, является улучшением L_RNA_scaffolder. 

На самом деле программ не так много. И работают они не идеально. Хочется попытаться 
улучшить текущий результат. К этому я еще вернусь, когда буду рассказывать про результаты. 

Так же одной из важной части моего проекта является визуализация графа контигов. Эта визуализация 
весьма помогает для понимания происходящего. 

И начну я свой рассказ о том, что на данный момент происходить в проекте как раз с визуализации. 

---8
Визуализация, на самом деле достаочно простая. Пусть у нас уже есть 
граф. Он разбивается на небольшие части, примерно по 10-20 вершин и каждая из 
частей выводится в отдельный файл в dot формате. Потом это все вместе собирается в один ps файл. 

На рисунке вершинами обозначаются контиги. А ребра - это предпологаемые связи между контигами. 
Здесь указано имя контига, внутренний id, его длина и если был предоставлен референс, то еще 
показывается координаты контига на референсе. 

Про связь мы указываем имя библиотеки. Вес ребра - это количество ридов на основание 
которых эта связь была проведена. Внутрений id ребра. И так же указываются координаты, куда выравнились риды, на основание которых была проведена связь, на контиг. Сейчас информация о координатах выравненых ридов еще находится в стадии разработки и пока не используется. 

Дальше одна из вершин окаршена в желтый. Это значит, что у этой вершины еще есть ребра, просто они попали в другой dot файл.   

Эта та информация, которая выводится обычно, далее картинки будут более упрощенные просто для того что бы картинки помещались на слайд. 

---9
Визуализировать можно связи разного вида. Здесь на рисунке красные ребра - это 
связи полученные с помощью выравнивания на эталлоную сборку. Синии - это как раз наши предполагаемые связи. В данном случае они двух разных типов, те которые называпются pair и split. Дальше я поясню что это значит. Так же можно визуализировать связи полученные по парным ридам ДНК. Зеленая, желтая и коричневая стрелочки - это разные скаффолдеры. Желтая - это мой скаффолдер. 

На этом рисунке, например, можно видеть что здесь я провожу связь, которую другие скаффолдеры не проводят и, например, здесь мой скаффолдер и P_RNA_Scaffolder ошибаются. 

Можно задавать какую библиотеку каким цветом отображать. 

---10
Так же для более удобного анализа графа есть возможность выводить не весь граф, а только какие-то 
его участки. Например, оставить только контиги определенного размера, убрать ребра маленького веса. Вевести только те участки, где есть расхождения в каких-то двух библиотеках или вывести только те участки, в которых содержатся ошибки.  


---11
Теперь, когда мы уже знакомы с тем, что какие картинки обозначают перейдем к часте про построение скаффолдов. 

Первое что делается - это строится граф контигов. Для нахождения связей используется РНК и используются связи двух видов. На рисунке желтым цветом изображаются экзоны. Первый вид связи - это по парным ридам. На рисунке эта связь изображается синим. Собственно выравниваются парные риды и на их основание строится граф. 

Второй вид связи чуть более хитрый. Иногда сами риды попадают на стык экзонов. То есть риды, можно разрезать на две части, выравнить отдельную из половин и если они выравнились на разные контиги - то мы нашли очередную сваязь. 

---12 
После того как мы построили граф следующий модуль упрощает его и строит скаффолды. 

Первое упрощение - это удаления ребер маленького веса. Ребра веса один скорее всего ошибочные. Более интересный случай, если есть ребро веса три. Если у него больше нет соперников, то его вполне можно использовать для проведения связей. При этом, если у него был сосед веса 1, то скорее всего это ребро использовать не стоит и его тоже нужно удалить. 

Следующая вполне расспространненая ситуация, когда у нас есть ребра вдоль пути. Такие ребра я удаляю при этом увеличивая вес ребер на этом пути. 

---13
Следующая достаточно частая ситуация, это такие небольшие циклы. Их я просто удаляю. 

Если есть какая-та развилка, и вес одного из ребер сильно привосходит остальные, то я оставляют 
только макисмальное ребро. 

И в конце, когда все упращения сделаны я соединяю контиги вдоль простых путей в скаффолды. 


---14
Теперь вернемся к результатам. Недавно я переписала часть с построением скаффолдов и 
не могу предоставить новые результаты. Даже более того, часть с построением скаффолдов сейчас находится в актичной трансформации поэтому совсем свежих результатов нет.

На самом деле вот конкретно на этих данных результаты получаются лучше чем у остальных. Я пока тестировала только на C.elegans еще на 6 разных библиотеках. Еще в ближайшее время посмотрю что 
будет с T.suis и D.mekangaster и вероятно с человеком. Пока еще нет. 

В среднем на самом деле получается что-то среднее между P_RNA_scaffolder и rascaf и по количеству ошибок и по NGA50. 

Конкретно на этих данных именно связей вида когда рид делится на 
две части достаточно много и они еще здесь почти без мусора получаются. 
Наверное самый клевый результат здесь достигался на этих данных, если 
вообще выкинуть все парные риды и оставить только split риды. 


 
---15
При работе над проектом использовалось достаточно 
много вспомогательных инструментов. Язык разработки данного 
приложения - С++. Использовалась библиоткеа SeqAn для 
работы с геномными файлами. gtest библиотека для тестирования. 
Различные тулы для выранивания. QUAST это программа, которая
умеет оценивать качество сборки. И Tablet использовался для 
визуализации выранивания. 

---16
В целом, написаны скаффолдер и визуализатор. 

И в общем-то надо то что есть привести в более приличные вид. 
Сделать его пошустрее. Сравнить нормально с другими скаффолдарами. 
И скаффолдер в целом у меня еще не в конечной стадии. Я еще активно его меняю.

---17
Спасибо за внимание! Вопросы. 
